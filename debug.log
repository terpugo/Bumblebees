+ '[' 2 -ne 2 ']'
+ profile=02
+ con_name=server1
+ auth_log=/root/containers/server1/rootfs/var/log/auth.log
+ '[' 02 = 02 ']'
+ mitm_port=10001
+ true
++ python3 -c 'import random; print(random.randint(1,3))'
+ num=1
+ echo config num is 1
++ date +%s
+ timestamp=1761791711
+ /home/aces/Bumblebees/creation server1 02 1 1761791711
+ data_collection=/home/aces/Bumblebees/Attacker_Data/server1_1761791711.txt
+ mitm_log=/home/aces/Bumblebees/server1_logs/server1_1761791711.log
+ sudo tail -n0 -F /root/containers/server1/rootfs/var/log/auth.log
+ read -r LINE
+ echo 'Oct 30 02:36:03 server1 useradd[1002]: new user: name=admin, UID=1001, GID=100, home=/home/admin, shell=/bin/bash, from=none'
+ grep -q 'Accepted password'
+ echo 'Oct 30 02:36:03 server1 useradd[1002]: new user: name=admin, UID=1001, GID=100, home=/home/admin, shell=/bin/bash, from=none'
+ grep -q 'Disconnected from user'
+ echo 'Oct 30 02:36:03 server1 useradd[1002]: new user: name=admin, UID=1001, GID=100, home=/home/admin, shell=/bin/bash, from=none'
+ grep -q 'Attacker timed out'
+ read -r LINE
+ echo 'Oct 30 02:36:03 server1 usermod[1011]: change user '\''admin'\'' password'
+ grep -q 'Accepted password'
+ echo 'Oct 30 02:36:03 server1 usermod[1011]: change user '\''admin'\'' password'
+ grep -q 'Disconnected from user'
+ echo 'Oct 30 02:36:03 server1 usermod[1011]: change user '\''admin'\'' password'
+ grep -q 'Attacker timed out'
+ read -r LINE
+ echo 'Oct 30 02:36:03 server1 sshd[1018]: Accepted password for admin from 172.20.0.1 port 60660 ssh2'
+ grep -q 'Accepted password'
++ sudo cat /root/containers/server1/rootfs/var/log/auth.log
++ grep 'Accepted password'
++ cut '-d ' -f11
+ attacker_ip=172.20.0.1
+ echo 172.20.0.1
+ sudo /sbin/iptables -I INPUT -d 172.20.0.1 -p tcp --dport 10001 -j DROP
+ sudo /sbin/iptables -I INPUT -s 172.20.0.1 -d 172.20.0.1 -p tcp --dport 10001 -j ACCEPT
+ sudo screen -dmS timer_server1 /home/aces/Bumblebees/time_attacker server1 1761791711
+ sudo screen -dmS idle_server1 /home/aces/Bumblebees/idle_time_new server1 120 1761791711
++ date
+ /home/aces/Bumblebees/slack.sh C09MYJC3M4N 'Wed 29 Oct 2025 10:36:03 PM EDT: attacker is inside server1'
cat: url.env: No such file or directory
curl: no URL specified!
curl: try 'curl --help' or 'curl --manual' for more information
+ echo 'Oct 30 02:36:03 server1 sshd[1018]: Accepted password for admin from 172.20.0.1 port 60660 ssh2'
+ grep -q 'Disconnected from user'
+ echo 'Oct 30 02:36:03 server1 sshd[1018]: Accepted password for admin from 172.20.0.1 port 60660 ssh2'
+ grep -q 'Attacker timed out'
+ read -r LINE
+ echo 'Oct 30 02:36:03 server1 sshd[1018]: pam_unix(sshd:session): session opened for user admin by (uid=0)'
+ grep -q 'Accepted password'
+ echo 'Oct 30 02:36:03 server1 sshd[1018]: pam_unix(sshd:session): session opened for user admin by (uid=0)'
+ grep -q 'Disconnected from user'
+ echo 'Oct 30 02:36:03 server1 sshd[1018]: pam_unix(sshd:session): session opened for user admin by (uid=0)'
+ grep -q 'Attacker timed out'
+ read -r LINE
+ echo 'Oct 30 02:36:03 server1 systemd-logind[244]: New session 11 of user admin.'
+ grep -q 'Accepted password'
+ echo 'Oct 30 02:36:03 server1 systemd-logind[244]: New session 11 of user admin.'
+ grep -q 'Disconnected from user'
+ echo 'Oct 30 02:36:03 server1 systemd-logind[244]: New session 11 of user admin.'
+ grep -q 'Attacker timed out'
+ read -r LINE
+ echo 'Oct 30 02:36:03 server1 systemd: pam_unix(systemd-user:session): session opened for user admin by (uid=0)'
+ grep -q 'Accepted password'
+ echo 'Oct 30 02:36:03 server1 systemd: pam_unix(systemd-user:session): session opened for user admin by (uid=0)'
+ grep -q 'Disconnected from user'
+ echo 'Oct 30 02:36:03 server1 systemd: pam_unix(systemd-user:session): session opened for user admin by (uid=0)'
+ grep -q 'Attacker timed out'
+ read -r LINE
+ echo 'Oct 30 02:37:03 server1 sshd[1080]: Received disconnect from 172.20.0.1 port 60660:11:'
+ grep -q 'Accepted password'
+ echo 'Oct 30 02:37:03 server1 sshd[1080]: Received disconnect from 172.20.0.1 port 60660:11:'
+ grep -q 'Disconnected from user'
+ echo 'Oct 30 02:37:03 server1 sshd[1080]: Received disconnect from 172.20.0.1 port 60660:11:'
+ grep -q 'Attacker timed out'
+ read -r LINE
+ echo 'Oct 30 02:37:03 server1 sshd[1080]: Disconnected from user admin 172.20.0.1 port 60660'
+ grep -q 'Accepted password'
+ grep -q 'Disconnected from user'
+ echo 'Oct 30 02:37:03 server1 sshd[1080]: Disconnected from user admin 172.20.0.1 port 60660'
++ date '+%Y-%m-%d %H:%M:%S.%3N'
+ out='2025-10-29 22:37:03.855'
+ echo '2025-10-29 22:37:03.855'
+ sudo /sbin/iptables -D INPUT -d 172.20.0.1 -p tcp --dport 10001 -j DROP
+ sudo /sbin/iptables -D INPUT -s 172.20.0.1 -d 172.20.0.1 -p tcp --dport 10001 -j ACCEPT
+ sudo pkill -f 'tail -n0 -F /root/containers/server1/rootfs/var/log/auth.log'
+ sudo screen -S timer_server1 -X quit
+ sudo screen -S idle_server1 -X quit
+ [[ Oct 30 02:37:03 server1 sshd[1080]: Disconnected from user admin 172.20.0.1 port 60660 == *\A\t\t\a\c\k\e\r\ \t\i\m\e\d\ \o\u\t* ]]
+ echo no
+ /home/aces/Bumblebees/deletion_script server1
+ sleep 2
+ /home/aces/Bumblebees/parsing_commands server1 1 1761791711
date: invalid date ‘1970-01-01 echo 2025-10-29 22:36:03.780 | cut -d' ' -f2’
date: invalid date ‘1970-01-01 echo 2025-10-29 22:37:03.855 | cut -d' ' -f2’
++ date
+ /home/aces/Bumblebees/slack.sh C09MYJC3M4N 'Wed 29 Oct 2025 10:37:10 PM EDT: attacker left at 2025-10-29 22:37:03.855, server1 deleted, and mitm log parsed'
cat: url.env: No such file or directory
curl: no URL specified!
curl: try 'curl --help' or 'curl --manual' for more information
+ break
+ sleep 1
+ true
++ python3 -c 'import random; print(random.randint(1,3))'
+ num=1
+ echo config num is 1
++ date +%s
+ timestamp=1761791831
+ /home/aces/Bumblebees/creation server1 02 1 1761791831
+ data_collection=/home/aces/Bumblebees/Attacker_Data/server1_1761791831.txt
+ mitm_log=/home/aces/Bumblebees/server1_logs/server1_1761791831.log
+ sudo tail -n0 -F /root/containers/server1/rootfs/var/log/auth.log
+ read -r LINE
